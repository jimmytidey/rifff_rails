function Timer(e){return this.settings=e,this.timer=null,this.fps=e.fps||30,this.interval=Math.floor(1e3/e.fps),this.timeInit=null,this}Timer.prototype={run:function(){var e=this;this.settings.run(),this.timeInit+=this.interval,this.timer=setTimeout(function(){e.run()},this.timeInit-(new Date).getTime())},start:function(){this.timer==null&&(this.timeInit=(new Date).getTime(),this.run())},stop:function(){clearTimeout(this.timer),this.timer=null}};var rifff={};self.onmessage=function(e){if(e.data.action=="play"){var t=!1;rifff.timer=new Timer({fps:parseFloat(e.data.data),run:function(){postMessage(t),t=!0}}),rifff.timer.start()}e.data.action=="stop"&&rifff.timer.stop()};